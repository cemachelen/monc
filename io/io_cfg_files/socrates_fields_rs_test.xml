<data-definition name="socrates_fields_data" frequency="{3d_sampling_frequency}" namespace="socrates_fields">
  <field name="flux_up_shortwave" type="array" data_type="double" size="z,y,x" collective=true optional=true/>
  <field name="flux_down_shortwave" type="array" data_type="double" size="z,y,x" collective=true optional=true/>
  <field name="flux_up_longwave" type="array" data_type="double" size="z,y,x" collective=true optional=true/>
  <field name="flux_down_longwave" type="array" data_type="double" size="z,y,x" collective=true optional=true/>
  <field name="shortwave_heating_rate" type="array" data_type="double" size="z,y,x" collective=true optional=true/>
  <field name="longwave_heating_rate" type="array" data_type="double" size="z,y,x" collective=true optional=true/>
  <field name="total_radiative_heating_rate" type="array" data_type="double" size="z,y,x" collective=true optional=true/>
  <!--2D field -->
  <field name="toa_up_longwave" type="array" data_type="double" size="y,x" collective=true optional=true/>
  <field name="surface_down_longwave" type="array" data_type="double" size="y,x" collective=true optional=true/>
  <field name="surface_up_longwave" type="array" data_type="double" size="y,x" collective=true optional=true/>
  <field name="toa_down_shortwave" type="array" data_type="double" size="y,x" collective=true optional=true/>
  <field name="toa_up_shortwave" type="array" data_type="double" size="y,x" collective=true optional=true/>
  <field name="surface_down_shortwave" type="array" data_type="double" size="y,x" collective=true optional=true/>
  <field name="surface_up_shortwave" type="array" data_type="double" size="y,x" collective=true optional=true/>
 </data-definition>

 <data-handling namespace="socrates_fields">
  <diagnostic field="flux_up_SW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="flux_up_SW_mean" equation="flux_up_SW_sum_g/({x_size}*{y_size}*{z_size})"/>
    <communication name="reduction" operator="sum" result="flux_up_SW_sum_g" field="flux_up_SW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="flux_up_SW_local_reduce" field="flux_up_shortwave"/>  
  </diagnostic>
  <diagnostic field="flux_down_SW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="flux_down_SW_mean" equation="flux_down_SW_sum_g/({x_size}*{y_size}*{z_size})"/>
    <communication name="reduction" operator="sum" result="flux_down_SW_sum_g" field="flux_down_SW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="flux_down_SW_local_reduce" field="flux_down_shortwave"/>
  </diagnostic>
  <diagnostic field="flux_up_LW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="flux_up_LW_mean" equation="flux_up_LW_sum_g/({x_size}*{y_size}*{z_size})"/>
    <communication name="reduction" operator="sum" result="flux_up_LW_sum_g" field="flux_up_LW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="flux_up_LW_local_reduce" field="flux_up_longwave"/>
  </diagnostic>
  <diagnostic field="flux_down_LW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="flux_down_LW_mean" equation="flux_down_LW_sum_g/({x_size}*{y_size}*{z_size})"/>
    <communication name="reduction" operator="sum" result="flux_down_LW_sum_g" field="flux_down_LW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="flux_down_LW_local_reduce" field="flux_down_longwave"/>
  </diagnostic>
  <diagnostic field="SW_heating_rate_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="SW_heating_rate_mean" equation="SW_heating_rate_sum_g/({x_size}*{y_size}*{z_size})"/>
    <communication name="reduction" operator="sum" result="SW_heating_rate_sum_g" field="SW_heating_rate_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="SW_heating_rate_local_reduce" field="shortwave_heating_rate"/>
  </diagnostic>
  <diagnostic field="LW_heating_rate_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="LW_heating_rate_mean" equation="LW_heating_rate_sum_g/({x_size}*{y_size}*{z_size})"/>
    <communication name="reduction" operator="sum" result="LW_heating_rate_sum_g" field="LW_heating_rate_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="LW_heating_rate_local_reduce" field="longwave_heating_rate"/>
  </diagnostic>
  <diagnostic field="total_radiative_heating_rate_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="total_radiative_heating_rate_mean" equation="total_radiative_heating_rate_sum_g/({x_size}*{y_size}*{z_size})"/>
    <communication name="reduction" operator="sum" result="total_radiative_heating_rate_sum_g" field="total_radiative_heating_rate_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="total_radiative_heating_rate_local_reduce" field="total_radiative_heating_rate"/>
  </diagnostic>
  
  <diagnostic field="toa_up_LW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="toa_up_LW_mean" equation="toa_up_LW_g/({x_size}*{y_size})"/>
    <communication name="reduction" operator="sum" result="toa_up_LW_g" field="toa_up_LW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="toa_up_LW_local_reduce" field="toa_up_longwave"/>
  </diagnostic>
  <diagnostic field="surface_down_LW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="surface_down_LW_mean" equation="surface_down_LW_g/({x_size}*{y_size})"/>
    <communication name="reduction" operator="sum" result="surface_down_LW_g" field="surface_down_LW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="surface_down_LW_local_reduce" field="surface_down_longwave"/>
  </diagnostic>
  <diagnostic field="surface_up_LW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="surface_up_LW_mean" equation="surface_up_LW_g/({x_size}*{y_size})"/>
    <communication name="reduction" operator="sum" result="surface_up_LW_g" field="surface_up_LW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="surface_up_LW_local_reduce" field="surface_up_longwave"/>
  </diagnostic>
  <diagnostic field="toa_down_SW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="toa_down_SW_mean" equation="toa_down_SW_g/({x_size}*{y_size})"/>
    <communication name="reduction" operator="sum" result="toa_down_SW_g" field="toa_down_SW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="toa_down_SW_local_reduce" field="toa_down_shortwave"/>
  </diagnostic>
  <diagnostic field="toa_up_SW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="toa_up_SW_mean" equation="toa_up_SW_g/({x_size}*{y_size})"/>
    <communication name="reduction" operator="sum" result="toa_up_SW_g" field="toa_up_SW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="toa_up_SW_local_reduce" field="toa_up_shortwave"/>
  </diagnostic>
  <diagnostic field="surface_down_SW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="surface_down_SW_mean" equation="surface_down_SW_g/({x_size}*{y_size})"/>
    <communication name="reduction" operator="sum" result="surface_down_SW_g" field="surface_down_SW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="surface_down_SW_local_reduce" field="surface_down_shortwave"/>
  </diagnostic>
  <diagnostic field="surface_up_SW_mean"  type="scalar" data_type="double" units="W m^-2">
    <operator name="arithmetic" result="surface_up_SW_mean" equation="surface_up_SW_g/({x_size}*{y_size})"/>
    <communication name="reduction" operator="sum" result="surface_up_SW_g" field="surface_up_SW_local_reduce" root="auto"/>
    <operator name="localreduce" operator="sum" result="surface_up_SW_local_reduce" field="surface_up_shortwave"/>
  </diagnostic>
</data-handling>

<group name="socrates_fields_profiles" namespace="socrates_fields">
  <member name="flux_up_SW_mean"/>
  <member name="flux_down_SW_mean"/>
  <member name="flux_up_LW_mean"/>
  <member name="flux_down_LW_mean"/>
  <member name="SW_heating_rate_mean"/>
  <member name="LW_heating_rate_mean"/>
  <member name="total_radiative_heating_rate_mean"/>

  <member name="toa_up_LW_mean"/>
  <member name="surface_down_LW_mean"/>
  <member name="surface_up_LW_mean"/>
  <member name="toa_down_SW_mean"/>
  <member name="toa_up_SW_mean"/>
  <member name="surface_down_SW_mean"/>
  <member name="surface_up_SW_mean"/>
 </group>

